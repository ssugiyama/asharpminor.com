---
type: post
title: この冬一番の寒さは一冬に何回あるか
author: sugi
layout: post
date: 2012-02-28
url: /saq/3076/
---
#### Q

2月も終わりだというのに、毎日のようにこの冬一番の寒さという表現をきくような気がしますが、その冬一番寒い日というのは一冬の間に平均して何回くらい期待できるものなのでしょう？

#### A

単純化するために、一冬の期間を12月から2月までの90日間とし気温の分布はその期間で変化しないものとします。今分布と書きましたが、実は気温の分布そのものはこの問題を考えるにあたっては無視できます。90日間の中でその日の寒さが何番目かという順序だけを考えればいいのです。寒さの順序を1〜90の整数で表し時系列順に並べて、たとえば 1,2,...,90 ならば最初の日に一番寒い日がきて、そのあと更新されないので、その冬の一番寒い日は1回だけ、逆に 90,89,88,...,1 ならば毎日更新されるので 90回ということになります。

さて、帰納的に考えてみましょう。1日の期間で考えると、必ず寒さ記録は更新されるので1回です。2日の期間で考えると、1,2 か 2,1 のどちらかなので 1回か2回、この2つの場合は同程度の頻度と考えられるので 1.5回が期待値です。3日間で考えると1日目は1か2か3のどれかが等確率。1ならば残りは2か3なので、今後は記録は更新されない。2ならば1により更新の可能性はあるが3は無視できる。つまり1だけを考えればよくなって1日の期間の場合と同じになる。3ならば、1，2両方に更新の可能性があるので2日間の場合と同じだ。

というわけで n日間の一番寒い日の日数の期待値 ecd(n) は以下の式で帰納的に求められる。なお ecd(0) = 0 とする。

$$
ecd(n) = 1 + \frac{1}{n} \sum_{i=0}^{n-1} {ecd(i)}
$$

で、ここでちょっと式変形をしてあげると

$$
ecd(n) - \frac{n-1}{n} ecd(n-1) = \frac{1}{n} + \frac{ecd(n-1)}{n}
$$

すなわち

$$
ecd(n) - ecd(n-1) = \frac{1}{n}
$$

となり、結局

$$
ecd(n) = \sum_{i=0}^{n} \frac{1}{i}
$$

つまり調和級数となるわけです。n がある程度大きくなれば自然対数を利用して

$$
ecd(n) \approx \log{n} + \gamma
$$

で求められます（\\( \gamma\\)はオイラー定数=0.5772...）。n=90 のときはだいたい 5.08 くらいで、つまり一冬の一番寒い日の期待回数はおよそ5回強です。
