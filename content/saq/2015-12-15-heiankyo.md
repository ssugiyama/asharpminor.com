+++
type = "post"
author = "sugi"
date = "2015-12-15T21:53:56+09:00"
title = "平安京のパラドックス"
tags = ["math"]
+++

### Q

無限に広い碁盤の目状に街路が広がる町があります。仮に平安京と呼んでおきましょう。問題は、平安京の中の任意の二点間を移動するとき街路上をつたっての最短経路と直線距離の比は平均していくつか、というものです。ただし、二点は街路の交差点上にあるものとします。

最小値は2点が同じ街路上にある場合の 1 で 最大値は対角線上にある場合の√2 ≒ 1.41421356… なので求めたい値がこの2つの間にあるのはまちがいありません。

{{% figure src="/images/saq/2015/circle.svg" class="alignleft" title="図1" %}}

出発点からみて目的地は周囲360度の方向に均等に分布していると仮定してよさそうな気がします。そうすると、簡単のために直線距離を1とおいても一般性を失いません。そうすると単位円の円周上の点の x座標とy座標の和が最短距離になり、角度をθとおくと  |sin θ| + |cos θ|で求まります（図1）。角度を第1象限の0 〜 π/2 に制限して考えれば絶対値の記号がとれて sin θ + cos θとかけます。これの平均を求めます。連続的に変化する値の平均を求めるには積分を使います（定積分で面積を求めて値域の幅で割る）。

<div>$$
        \frac{\int^{\frac{\pi}{2}}_0 \sin \theta + \cos \theta d\theta}{\pi/2} =\frac{2}{\pi} [-\cos\theta + \sin\theta]^{\frac{\pi}{2}}_0 = \frac{4}{\pi}
$$
</div>

小数点展開すると 1.27323954473516…となります。

----

{{% figure src="/images/saq/2015/square.svg" class="alignleft"title="図2" %}}

今の計算では目的地が円周上に均等に分布しているとしましたが、町の街路の並びを考えると正方形のブロックの辺に均等に分布していると考えるのもありだと思います。図2を参照してください。これで同じく平均を計算すると以下のようになります。

$$
\int^1_0 \frac{1+x}{\sqrt{1+x^2}} dx = [\sinh^{-1} x + \sqrt{1+x^2}]^1_0 = \log{(1+\sqrt{2})} + \sqrt{2} -1
$$

小数点展開すると 1.29558714939264… となります。

----

{{% figure src="/images/saq/2015/triangle.svg" class="alignleft" title="図3" %}}

さらに、目的地までの最短距離を一定にして直線距離を変えていくことも考えられます。図3のように斜線の上に目的地が均等に分布しているわけです。これの平均を計算すると、

<div>$$
\int^1_0 \frac{1}{\sqrt{x^2 + (1-x)^2}} dx = [\frac{\sinh^{-1}(2x-1)}{\sqrt{2}}]^1_0 = \sqrt{2} \log{(1+\sqrt{2})}
$$</div>

小数点展開すると 1.24645048028046… となります。

さて三者三様けっこう値が違いますがどれが正しいのでしょう？

### A

結論から言うとみんな正解です。

最初この3つの計算の違いは目的地の分布の仕方の違いで格子状の街なら正方形ベースの2番目の値が正しいのではないかと思いましたがそういう問題ではなかったです。

結局はどの範囲から任意の二点を選ぶのかということです。出発点を選んだあと目的地を選ぶ範囲が正方形のように格子の対角線方向に厚いと大きな数字になるし、三角形のように薄いと小さな数字になります。

つまり、問題文では「無限に広い」というざっくりした書き方がされてますが、どのような形状を無限に広げていったのかによって結果が異なります。

無理に優劣をつけるならどれが一番自然かという話になってきます。碁盤の目状なので正方形が一番しっくりくるということはいえるかもしれないです。
